<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projack Impulse - Projeto Individual</title>

  <!-- Fontes -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quantico&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poetsen+One&display=swap">

  <!-- CSS (rotas din√¢micas via Flask) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/geral.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/descricao.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/repositorios.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/tecnologias.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/colaboradores.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/solicitacoes.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/editar_e_excluir.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/edicao.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/exclusao.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/css_projeto_individual/ia.css') }}">
</head>

<body>

<!-- Cabe√ßalho -->
<header class="cabecalho">
  <button class="btn-voltar" onclick="voltarPagina()">
    <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/voltar.png') }}" alt="Bot√£o voltar" />
  </button>
</header>

  <div class="tela">

    <!-- BLOCO 1: Descri√ß√£o e subbloco direito -->
    <div class="bloco bloco1">

      <!-- Descri√ß√£o do projeto -->
      <div class="descricao">
        <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/estrelas.png') }}" alt="Estrelas" class="imagem_estrelas">
        <h2 class="titulo_descricao">Descri√ß√£o</h2>
        <p class="texto" id="descricaoProjeto"></p>
        <p class="nivel"><span class="label">N√≠vel: </span> <span class="valor" id="nivelProjeto"></span></p>
        <p class="categoria"><span class="label">Categoria: </span> <span class="valor" id="categoriaProjeto"></span></p>
        <p class="status"><span class="label">Status: </span> <span class="valor" id="statusProjeto"></span></p> <!-- Status adicionado -->
      </div>

      <!-- Subbloco direito -->
      <div class="subbloco_direito">

        <!-- Tecnologias -->
        <div class="tecnologia">
          <div class="tecnologia-header">
            <h3>Tecnologias:</h3>
            <div class="botoes">
              <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/mais.png') }}" alt="Adicionar" class="btn-img" id="btnAdd">
              <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/menos.png') }}" alt="Excluir" class="btn-img" id="btnDelete">
            </div>
          </div>
          <div class="tecnologia-lista" id="listaTecnologias"></div>
        </div>

        <!-- Reposit√≥rios -->
        <div class="repositorio">
          <div class="repositorio-header">
            <h3>Reposit√≥rios:</h3>
            <div class="botoes">
              <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/mais.png') }}" alt="Adicionar" class="btn-img" id="btnAddRepo">
              <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/menos.png') }}" alt="Excluir" class="btn-img" id="btnDeleteRepo">
            </div>
          </div>
          <div class="repositorio-lista" id="listaRepositorios"></div>
        </div>

      </div>
    </div>

    <!-- BLOCO 2: Colaboradores e Solicita√ß√µes -->
    <div class="bloco bloco2">
      <div class="colaboradores">
        <h3 class="titulo_colaboradores">Colaboradores</h3>
        <div class="lista_colaboradores" id="listaColaboradores"></div>
      </div>

      <div class="solicitacoes">
        <div class="solicitacoes-header">
          <img 
            src="{{ url_for('static', filename='imagens/imagens_projeto_individual/solicitacoes.png') }}" 
            alt="Solicita√ß√µes" 
            class="titulo_solicitacoes_img"
          >

          <button 
            id="botaoSelecionarIA" 
            class="botao-ia" 
            title="Use a IA para selecionar automaticamente os 5 melhores colaboradores para o projeto"
          >
            ü§ñ
          </button>
        </div>

        <div class="lista_solicitacoes" id="listaSolicitacoes"></div>
      </div>


    </div>

    <!-- BLOCO 3: Editar / Excluir -->
    <div class="bloco bloco3">
      <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/editar.png') }}" alt="Editar" class="btn-editar">
      <img src="{{ url_for('static', filename='imagens/imagens_projeto_individual/excluir.png') }}" alt="Excluir" class="btn-excluir">
    </div>

  </div>

  <!-- Modal de Edi√ß√£o -->
  <div id="modalEdicao">
    <div class="modal-conteudo">
      <h2>Editar Projeto</h2>

      <div class="modal-colunas">
        <!-- Coluna esquerda -->
        <div class="modal-coluna">
          <label for="editDescricao">Descri√ß√£o:</label>
          <textarea id="editDescricao"></textarea>

          <label for="editNivel">N√≠vel:</label>
          <select id="editNivel" required>
            <option value="B√°sico">B√°sico</option>
            <option value="Intermedi√°rio">Intermedi√°rio</option>
            <option value="Dif√≠cil">Dif√≠cil</option>
          </select>

          <label for="editCategoria">Categoria:</label>
          <input type="text" id="editCategoria">

          <!-- Adicionando campo de Status -->
          <label for="editStatus">Status:</label>
          <select id="editStatus" required>
            <option value="Em andamento">Em andamento</option>
            <option value="Conclu√≠do">Conclu√≠do</option>
          </select>
        </div>

        <!-- Coluna direita -->
        <div class="modal-coluna">
          <label for="editTecnologias">Tecnologias:</label>
          <div id="editTecnologias"></div>

          <label for="editRepositorios">Reposit√≥rios:</label>
          <div id="editRepositorios"></div>
        </div>
      </div>

      <div class="modal-botoes">
        <button id="btnCancelarModal">Cancelar</button>
        <button id="btnSalvarModal">Salvar</button>
      </div>
    </div>
  </div>

<!-- ===============================
     üîπ MODAL DE SOLICITA√á√ÉO IA
=============================== -->
<div id="modalIA" class="modal-ia">
  <div class="modal-ia-content">
    <button class="fechar-ia" id="btnFecharIA">‚úñ</button>
    <h2>Assistente de Sele√ß√£o de Colaboradores ü§ñ</h2>
    <p>Deseja que a IA analise as solicita√ß√µes e escolha os 5 melhores colaboradores para este projeto?</p>
    <div class="modal-ia-buttons">
      <button id="btnConfirmarIA">Sim, analisar</button>
      <button id="btnCancelarIA">Cancelar</button>
    </div>
    <div id="iaResultado" class="ia-resultado"></div>
  </div>
</div>


  <!-- ===============================
       üîπ SCRIPT GLOBAL ‚Äî define o ID do projeto
   =============================== -->
   <script>
    window.repoIdProjeto = Number("{{ id_projeto }}");
    console.log("üìå ID do projeto atual:", window.repoIdProjeto); // Debug
  </script>

<!-- JS (rotas din√¢micas via Flask) -->
<script src="{{ url_for('static', filename='js/js_projeto_individual/descricao.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/repositorios.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/tecnologias.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/colaboradores.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/solicitacoes.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/edicao.js') }}"></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/exclusao.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/js_projeto_individual/ia.js') }}"></script>

<script>
  // Fun√ß√£o para voltar √† p√°gina de projetos
  async function voltarPagina() {
    try {
      // Fazendo a requisi√ß√£o para a API para buscar os detalhes do projeto
      const resposta = await fetch(`${API_BASE}/projeto/${projetoId}`);
      
      // Verifica se a resposta foi bem-sucedida
      if (!resposta.ok) {
        throw new Error('Erro ao buscar o projeto.');
      }

      // Obt√©m os dados do projeto em formato JSON
      const dadosProjeto = await resposta.json();

      // Exibe a resposta completa da API para depura√ß√£o
      console.log("Resposta da API:", dadosProjeto);

      // Pega o id_idealizador diretamente da resposta
      const id_usuario = dadosProjeto.projeto.id_idealizador;

      // Verifica se o id_usuario est√° presente
      if (!id_usuario) {
        throw new Error('ID do usu√°rio n√£o encontrado no projeto.');
      }

      // Exibe o ID do usu√°rio no console
      console.log("ID do usu√°rio:", id_usuario);

      // Redireciona para a p√°gina de projetos do usu√°rio
      window.location.href = `/projetos/${id_usuario}`;
    } catch (erro) {
      // Se ocorrer algum erro, exibe a mensagem de erro no console
      console.error('Erro:', erro);
    }
  }
</script>



</body>
</html>
